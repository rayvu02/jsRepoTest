<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" type="text/css" href="https://reedautomarketing.github.io/autoSpecials/output.css">
</head>

<body class="font-sans bg-white" id="rag-auto">
  <div class="bg-rag-test-custom">
    <h2 class="text-3xl pt-2 pb-2 p-5 font-bold tracking-tight text-white sm:text-4xl text-center">New Vehicle Offers &
      Incentives</h2>
    <p class="text-center pb-2 mb-5 text-lg leading-8 text-white">Reed Ford of Kansas City</p>
  </div>
  <div class="spacer"></div>
  <div id="offers-container" class=""></div>
  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
  <script>
    function fetchOffers() {
      const targetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRTqMMIq6hYycwe-QiCokW00vnrP1rdI30c9rj7u82gtdEmtQZa7nXV42dHhPeFwe99cogN1JpqJB9x/pub?gid=976470551&single=true&output=csv';

      fetch(targetUrl)
        .then(response => response.text())
        .then(csvData => {
          const offers = csvData.split('\r\n').slice(10); // Remove the header row and empty row
          console.log("Offers:", offers);  // Log the offers array
          const offersContainer = document.createElement('div');
          offersContainer.className = "container mx-auto md:px-2 bg-[#F8F8F8]";
          let counter = 0;
 
          offers.forEach((offer, index) => {
            const offerData = offer.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
            console.log("Offer Data:", offerData);  // Log the offerData array for each offer

            // Skip offers without "Contains Offer" = TRUE
            if (offerData.length < 6 || offerData[3].toLowerCase() !== 'true') return;

            // Decide whether to use the layout for Row 1 or Row 2
            const rowLayout = counter % 2 === 0 ? 'row-reverse' : 'row';
            const offerHtml = document.createElement('div');
            offerHtml.className = `offer-rag-row flex flex-col flex-wrap lg:flex-nowrap md:flex-${rowLayout} md:py-11 md:mx-11 py-10 rounded-lg items-center justify-center`;
            offerHtml.innerHTML = `
            <div class="lg:hidden w-3/4 flex flex-col justify-start items-center column-gradient-border z-0 -mb-5">
                    <li class="is-active mt-3 pb-2 m-6">
                      <button>Special Offer</button>
                    </li>
                </div>  
              <div class="w-3/4 lg:w-2/3 relative z-10">
                <img src="${offerData[4].replace(/"/g, '')}" alt="${offerData[0].replace(/"/g, '')}" class="lg:rounded w-full lg:shadow-2xl sm:jv-fix lg:${counter % 2 === 0 ? 'memeLordA' : 'memeLordB'}">
                <div class="text-white text-lg lg:text-xl font-bold absolute bottom-2 left-2 uppercase">${offerData[0].replace(/"/g, '')}</div>
              </div>
              <div class="w-3/4 lg:w-1/3 lg:m-0 lg:p-0 -mt-4 md:-mt-5 md:mx-5 justify-center rounded lg:shadow-2xl column-gradient-border z-0 lg:${counter % 2 === 0 ? '-mr-6' : '-ml-6'}">
                <div class="md:m-5 md:p-2 md:py-5 my-6 mx-2 p-0">
                  <div class="collapse lg:visible lg:w-full flex flex-col justify-center items-center lg:${counter % 2 === 0 ? '-ml-6' : '-mr-6'}">
                    <li class="is-active lg:mb-10 lg:pb-2">
                      <button>Special Offer</button>
                    </li>
                </div> 
                <div class="md:w-full flex flex-col justify-start items-center">
                  <div class="text-[#333] md:leading-normal leading-4 text-lg uppercase font-normal text-center mb-2 lg:${counter % 2 === 0 ? '-ml-6' : '-mr-6'}">${offerData[0].replace(/"/g, '')}</div>
                  <div class="text-[#333] text-3xl lg:text-4xl font-bold text-center mb-2 lg:${counter % 2 === 0 ? '-ml-6' : '-mr-6'}">${offerData[1].replace(/"/g, '')}</div>
                  <div class="text-[#333] md:leading-normal leading-4 text-lg font-normal text-center mb-2 lg:${counter % 2 === 0 ? '-ml-6' : '-mr-6'}">Total Savings</div>
                  <a href="${offerData[5].replace(/"/g, '')}" class="bg-btn-rag font-bold text-white mt-5 py-2 px-5 rounded w-2/3 text-center mt-10 lg:${counter % 2 === 0 ? '-ml-6' : '-mr-6'}">Shop Now</a>
                </div>
                </div>
              </div>
            `;
            offersContainer.appendChild(offerHtml);

            if (index < offers.length - 1) {
              const spacer = document.createElement('div');
              spacer.className = 'spacer';
              offersContainer.appendChild(spacer);
            }

            counter++;
          });

          // Append offers container to body
          document.getElementById('offers-container').appendChild(offersContainer);
        })
        .catch(error => console.error('Error:', error)); // Log any errors that occur during the fetch operation
    }

    fetchOffers();
  </script>
</body>

</html>
 